import socket,time,subprocess

host = '127.0.0.1'  
port = 8080        
    
def bruteforce(dict:str, username:str):
    
    with open(dict, 'r') as file:
            for password in file:
                password = password.strip()  # Nettoyer les espaces et sauts de ligne
                
                # Préparer les entrées pour le programme
                input_data = f"{username} {password}"
                input_bytes = input_data.encode('utf-8')  # S'assurer que l'encodage est fait ici
                
                # Exécuter le programme avec les entrées
                
                # Décoder la sortie pour vérifier si le mot de passe est correct
                try:
                    client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                    client_socket.connect((host, port))
                    # Send data to the server
                    client_socket.sendall(input_bytes)
                    response = client_socket.recv(1024)
                    print("STR envoyée : {input_data} / {input_bytes}")
                    # Receive response fromthe server
                    print("Response from server:", response.decode())
                    if(response.decode('utf-8').lower()=="accès autorisé.\n"):
                        print("Le mot de passe est : ",password)
                        client_socket.close()
                        return 1
                    time.sleep(0.3)

                except Exception as e:
                    print("Error :",e)
        

# Create a TCP socket
bruteforce("./dict.txt","admin")

